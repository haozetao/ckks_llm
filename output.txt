0.6746234435e21
1.000000092
logN: 16 Pnum: 4 Qnum: 28 Tnum: 8 gamma: 4
dnum: 7 Ri_blockNum: 8, Qj_blockNum: 7
Generate Context OK
Generate Scheme OK
Generate sk OK
Generate pk OK
Generate rlk OK
m_paramsEnc gs: 16
m_paramsEnc gsRem: 8
m_paramsDec gs: 16
m_paramsDec gsRem: 8
sqrt_rescale: 115571923300
numRotations: 31
numRotationsRem: 15
N: 65536
M: 131072
K: 4
rot_in_S2C: 
32753, 32754, 32755, 32756, 32757, 32758, 32759, 32760, 32761, 32762, 32763, 32764, 32765, 32766, 32767, 0, 
rot_out_S2C[s][i]: 
0, 16, 
rot_in_S2C: 
32528, 32544, 32560, 32576, 32592, 32608, 32624, 32640, 32656, 32672, 32688, 32704, 32720, 32736, 32752, 0, 
rot_out_S2C[s][i]: 
0, 256, 
rot_in_S2C: 
28928, 29184, 29440, 29696, 29952, 30208, 30464, 30720, 30976, 31232, 31488, 31744, 32000, 32256, 32512, 0, 
rot_out_S2C[s][i]: 
0, 4096, 
rot_in_S2C rem: 
4096, 8192, 12288, 16384, 20480, 24576, 28672, 0, 
rot_out_S2C rem: 
0, 0, 
rot_in_C2S: 
2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432, 20480, 22528, 24576, 26624, 28672, 30720, 0, 
rot_out_C2S: 
0, 0, 
rot_in_C2S: 
30848, 30976, 31104, 31232, 31360, 31488, 31616, 31744, 31872, 32000, 32128, 32256, 32384, 32512, 32640, 0, 
rot_out_C2S: 
0, 2048, 
rot_in_C2S: 
32648, 32656, 32664, 32672, 32680, 32688, 32696, 32704, 32712, 32720, 32728, 32736, 32744, 32752, 32760, 0, 
rot_out_C2S: 
0, 128, 
rot_in_C2S rem: 
32761, 32762, 32763, 32764, 32765, 32766, 32767, 0, 
rot_out_C2S rem: 
0, 8, 
pq_ringpack[i]: 562949997330433
pq_ringpack[i]: 562949979504641
pq_ringpack[i]: 562949982781441
before key gen Key.L: 1, K: 1, dnum: 1
prepare reduce sum mask
prepare Q*K^T mask
d=64
add CCMM & reduce sum Keys
log2(d): 6.000000
1, 32767, 2, 32766, 4, 32764, 8, 32760, 16, 32752, 32, 32736, 64, 32704, 128, 32640, 256, 32512, 16384, 256, 4096, 0, 2048, 4096, 6144, 8192, 10240, 12288, 14336, 16384, 18432, 20480, 22528, 24576, 26624, 28672, 30720, 0, 256, 512, 768, 32705, 
Element[0] = 9.803408e-01
Element[1] = 9.599690e-01
Element[2] = 9.636899e-01
Element[3] = 9.603653e-01
Element[4] = 9.801324e-01
Element[5] = 9.852302e-01
Element[6] = 9.647495e-01
Element[7] = 9.731580e-01
Element[8] = 9.503734e-01
Element[9] = 9.454536e-01
message_host[0]= 0.0510283
message_host[512*128]= 0.165357
mul_res[0]= 0.00464482
mul_res[1]= -0.0016875
mul_res[512]= 0.0042785
encode coeff mx = [[28726391972827, 46851713836329, 36101602429187, 18770882754944, 65669202898823, 455754341212917, 498146499261042, 28614528253197, 464204890528319, 36867466283471, 556836708803961, 528285833168767, 83253324681154, 19235330590019, 22986315966098, 538876834149620, ],
[28726391972827, 46851713836329, 36101602429187, 18770882754944, 65669202898823, 455754344489717, 498146502537842, 28614528253197, 464204893805119, 36867466283471, 556836712080761, 528285836445567, 83253324681154, 19235330590019, 22986315966098, 538876837426420, ],
encode coeff mx = [[93087832002030, 103527272330663, 529818804132772, 512166946571403, 522854409135966, 521591832923461, 62523271931243, 465217450480713, 511378688657565, 465748252746150, 17999606991465, 452707967816461, 88583658085457, 108288000482424, 541482147514798, 472293593646090, ],
[93087832002030, 103527272330663, 529818807409572, 512166949848203, 522854412412766, 521591836200261, 62523271931243, 465217453757513, 511378691934365, 465748256022950, 17999606991465, 452707971093261, 88583658085457, 108288000482424, 541482150791598, 472293596922890, ],
c1 = [0.05102832, 0.08322536, 0.06412933, 0.03334379, 0.11665194, -0.19041771, -0.11511411, 0.05082961, ], max: 0.19999753
c2 = [0.16535721, 0.18390138, -0.05885279, -0.09020879, -0.07122404, -0.07346683, 0.11106364, -0.17360785, ], max: 0.19999854
begin infer
X.level before qkv: 1
(*X[0]).L 27
mlwe_num = 3072
scaler: 562949953421312
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 168.77364
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
111
mlwe_num = 3072
scaler: 562949924061184
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 172.75801
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
222
mlwe_num = 3072
scaler: 562949865340933
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 172.28799
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 18
after EvalModAndEqual level 6
after multConstAndEqual level 6
333
Q.level after qkv: 13
Q.level before qk: 13
Q.scale before qk: 0.5629500912e15
const scale6802415574
const scale6802415574
const scale6802415574
O.level after qk: 8
O.scale after qk: 0.5553537655e15
O.scale before attn_Softmax_phase1: 0.5553537655e15
level at begin 8
level at begin 8
level at begin 8
O.scale after attn_Softmax_phase1: 0.4442830124e16
O.level after softmax1: 3
O.scale before softmax2: 0.4442830199e16
O.level before softmax2: 15
before evalSoftMax_phase2 scale 0.4442830199e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4442830239e16
cipher->scale = 0.4442830239e16
bx->scale = 0.4442830239e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5201739419e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5201739419e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3045141445e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3045141445e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3601116291e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1947936655e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1459434393e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1459434393e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2174541057e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5637445851e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5321639966e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5321639966e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8384952245e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.7926405371e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7912458662e28
target_scale = 0.4442830239e16
bx->scale = 0.7912458662e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4442830239e16
tt = 1.7546815e-14
bx->scale = 0.4442830239e16
bx->scale = 7.892051592
after evalInv (*nonlieanr_buffer[0]).scale 7.892051592
after evalInv (*cipher_P[0]).scale 0.4442830199e16
after evalSoftMax_phase2 scale 62.28447856
before evalSoftMax_phase2 scale 0.4442830199e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4442830239e16
cipher->scale = 0.4442830239e16
bx->scale = 0.4442830239e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5201739419e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5201739419e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3045141445e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3045141445e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3601116291e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1947936655e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1459434393e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1459434393e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2174541057e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5637445851e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5321639966e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5321639966e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8384952245e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.7926405371e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7912458662e28
target_scale = 0.4442830239e16
bx->scale = 0.7912458662e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4442830239e16
tt = 1.7546815e-14
bx->scale = 0.4442830239e16
bx->scale = 7.892051592
after evalInv (*nonlieanr_buffer[0]).scale 7.892051592
after evalInv (*cipher_P[0]).scale 0.4442830199e16
after evalSoftMax_phase2 scale 62.28447856
before evalSoftMax_phase2 scale 0.4442830199e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4442830239e16
cipher->scale = 0.4442830239e16
bx->scale = 0.4442830239e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5201739419e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5201739419e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3045141445e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3045141445e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3601116291e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1947936655e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1459434393e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1459434393e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2174541057e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5637445851e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5321639966e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5321639966e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8384952245e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.7926405371e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7912458662e28
target_scale = 0.4442830239e16
bx->scale = 0.7912458662e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4442830239e16
tt = 1.7546815e-14
bx->scale = 0.4442830239e16
bx->scale = 7.892051592
after evalInv (*nonlieanr_buffer[0]).scale 7.892051592
after evalInv (*cipher_P[0]).scale 0.4442830199e16
after evalSoftMax_phase2 scale 62.28447856
O.scale after softmax2: 62.28447856
O.level after softmax2: 7
O.level before mulV: 7
V.level before mulV: 6
O.scale before mulV: 62.28447856
V.scale before mulV: 0.5629496234e15
mulV_res.level after mulV: 4
mulV_res.scale after mulV: 62.28444644
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
mlwe_num = 3072
pcmm input level 4
scaler: 562949747900450
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 169.23955
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 27
after EvalModAndEqual level 15
after multConstAndEqual level 15
attn_output pcmm time 362.34036
O.level before LayerNorm phase 1: 15
O.scale before LayerNorm phase 1: 0.5629496125e15
LayerNorm_Bert input scale 0.5629496125e15
LayerNorm_Bert after sum_x scale 0.5629496125e15
LayerNorm_Bert after reduce sum scale 0.5629496175e15
LayerNorm_Bert after square sum_x scale 0.5629496175e15
LayerNorm_Bert after square tmp_cipher scale 0.5629492762e15
LayerNorm_Bert after reduce sum phase1 scale 0.5629492762e15
LayerNorm_Bert after reduce sum phase2 scale 0.5629492791e15
LayerNorm_Bert before sqrtInv sum_x scale 0.5629492791e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.5629492791e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.5629496125e15
LayerNorm_Bert finish scale 0.5629489588e15
O.level after LayerNorm phase 1: 5
O.scale after LayerNorm phase 1: 0.5629489588e15
attn_output_layernorm time 39.003136
O.level after LayerNorm phase 2: 4
O.scale after LayerNorm phase 2: 0.5629489779e15
scaler: 562949513019557
smem size:16384
call 1 mat_N = 768
pcmm_block(96, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
intermediate pcmm time 1219.5768
res[0].scale before evalGeLU: 0.5629492759e15
intermediate evalGeLU time 135.95955
res[0].scale after evalGeLU: 0.5629486174e15
scaler: 562949043258065
smem size:16384
call 1 mat_N = 3072
pcmm_block(24, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 256
layer_output pcmm time 878.46503
before LayerNorm_phase1 LayerNorm_input[0] scale 0.5629482032e15
LayerNorm_Bert input scale 0.5629482032e15
LayerNorm_Bert after sum_x scale 0.5629482032e15
LayerNorm_Bert after reduce sum scale 0.5629482082e15
LayerNorm_Bert after square sum_x scale 0.5629482082e15
LayerNorm_Bert after square tmp_cipher scale 0.5629464576e15
LayerNorm_Bert after reduce sum phase1 scale 0.5629464576e15
LayerNorm_Bert after reduce sum phase2 scale 0.5629464605e15
LayerNorm_Bert before sqrtInv sum_x scale 0.5629464605e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.5629464605e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.5629482032e15
LayerNorm_Bert finish scale 0.562944731e15
after LayerNorm_phase1 LayerNorm_input[0] scale 0.562944731e15
layer_output LayerNorm time 39.33696
after LayerNorm_phase2 LayerNorm_input[0] scale 0.56294475e15
after layer_output LayerNorm and s2c level 1
after layer scale 0.5629447078e15






X.level before qkv: 1
(*X[0]).L 27
mlwe_num = 3072
scaler: 562948103736257
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.20723
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
111
mlwe_num = 3072
scaler: 562946224697345
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.98035
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
222
mlwe_num = 3072
scaler: 562942466638336
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.27379
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 18
after EvalModAndEqual level 6
after multConstAndEqual level 6
333
Q.level after qkv: 13
Q.level before qk: 13
Q.scale before qk: 0.5629463918e15
const scale6802415574
const scale6802415574
const scale6802415574
O.level after qk: 8
O.scale after qk: 0.5553428172e15
O.scale before attn_Softmax_phase1: 0.5553428172e15
level at begin 8
level at begin 8
level at begin 8
O.scale after attn_Softmax_phase1: 0.4442742538e16
O.level after softmax1: 3
O.scale before softmax2: 0.4442742613e16
O.level before softmax2: 15
before evalSoftMax_phase2 scale 0.4442742613e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4442742652e16
cipher->scale = 0.4442742652e16
bx->scale = 0.4442742652e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5201636872e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5201636872e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3045081413e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3045081413e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3600974307e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1947821453e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1459348081e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1459348081e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2174369586e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5636667939e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5320905633e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5320905633e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8383629926e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.7924061772e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7910119187e28
target_scale = 0.4442742652e16
bx->scale = 0.7910119187e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4442742652e16
tt = 1.7551658e-14
bx->scale = 0.4442742652e16
bx->scale = 7.891896008
after evalInv (*nonlieanr_buffer[0]).scale 7.891896008
after evalInv (*cipher_P[0]).scale 0.4442742613e16
after evalSoftMax_phase2 scale 62.28202283
before evalSoftMax_phase2 scale 0.4442742613e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4442742652e16
cipher->scale = 0.4442742652e16
bx->scale = 0.4442742652e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5201636872e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5201636872e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3045081413e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3045081413e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3600974307e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1947821453e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1459348081e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1459348081e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2174369586e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5636667939e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5320905633e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5320905633e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8383629926e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.7924061772e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7910119187e28
target_scale = 0.4442742652e16
bx->scale = 0.7910119187e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4442742652e16
tt = 1.7551658e-14
bx->scale = 0.4442742652e16
bx->scale = 7.891896008
after evalInv (*nonlieanr_buffer[0]).scale 7.891896008
after evalInv (*cipher_P[0]).scale 0.4442742613e16
after evalSoftMax_phase2 scale 62.28202283
before evalSoftMax_phase2 scale 0.4442742613e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4442742652e16
cipher->scale = 0.4442742652e16
bx->scale = 0.4442742652e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5201636872e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5201636872e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3045081413e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3045081413e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3600974307e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1947821453e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1459348081e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1459348081e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2174369586e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5636667939e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5320905633e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5320905633e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8383629926e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.7924061772e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7910119187e28
target_scale = 0.4442742652e16
bx->scale = 0.7910119187e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4442742652e16
tt = 1.7551658e-14
bx->scale = 0.4442742652e16
bx->scale = 7.891896008
after evalInv (*nonlieanr_buffer[0]).scale 7.891896008
after evalInv (*cipher_P[0]).scale 0.4442742613e16
after evalSoftMax_phase2 scale 62.28202283
O.scale after softmax2: 62.28202283
O.level after softmax2: 7
O.level before mulV: 7
V.level before mulV: 6
O.scale before mulV: 62.28202283
V.scale before mulV: 0.5629348261e15
mulV_res.level after mulV: 4
mulV_res.scale after mulV: 62.28035361
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
mlwe_num = 3072
pcmm input level 4
scaler: 562934950595582
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 168.77055
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 27
after EvalModAndEqual level 15
after multConstAndEqual level 15
attn_output pcmm time 362.11508
O.level before LayerNorm phase 1: 15
O.scale before LayerNorm phase 1: 0.5629200183e15
LayerNorm_Bert input scale 0.5629200183e15
LayerNorm_Bert after sum_x scale 0.5629200183e15
LayerNorm_Bert after reduce sum scale 0.5629200233e15
LayerNorm_Bert after square sum_x scale 0.5629200233e15
LayerNorm_Bert after square tmp_cipher scale 0.5628900893e15
LayerNorm_Bert after reduce sum phase1 scale 0.5628900893e15
LayerNorm_Bert after reduce sum phase2 scale 0.5628900922e15
LayerNorm_Bert before sqrtInv sum_x scale 0.5628900922e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.5628900922e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.5629200183e15
LayerNorm_Bert finish scale 0.562860181e15
O.level after LayerNorm phase 1: 5
O.scale after LayerNorm phase 1: 0.562860181e15
attn_output_layernorm time 38.981632
O.level after LayerNorm phase 2: 4
O.scale after LayerNorm phase 2: 0.5628602e15
scaler: 562919918811120
smem size:16384
call 1 mat_N = 768
pcmm_block(96, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
intermediate pcmm time 1221.5951
res[0].scale before evalGeLU: 0.5628900891e15
intermediate evalGeLU time 136.66508
res[0].scale after evalGeLU: 0.5628302501e15
scaler: 562889856446346
smem size:16384
call 1 mat_N = 3072
pcmm_block(24, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 256
layer_output pcmm time 878.03497
before LayerNorm_phase1 LayerNorm_input[0] scale 0.562829836e15
LayerNorm_Bert input scale 0.562829836e15
LayerNorm_Bert after sum_x scale 0.562829836e15
LayerNorm_Bert after reduce sum scale 0.562829841e15
LayerNorm_Bert after square sum_x scale 0.562829841e15
LayerNorm_Bert after square tmp_cipher scale 0.5627097488e15
LayerNorm_Bert after reduce sum phase1 scale 0.5627097488e15
LayerNorm_Bert after reduce sum phase2 scale 0.5627097517e15
LayerNorm_Bert before sqrtInv sum_x scale 0.5627097517e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.5627097517e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.562829836e15
LayerNorm_Bert finish scale 0.5625897062e15
after LayerNorm_phase1 LayerNorm_input[0] scale 0.5625897062e15
layer_output LayerNorm time 39.268353
after LayerNorm_phase2 LayerNorm_input[0] scale 0.5625897252e15
after layer_output LayerNorm and s2c level 1
after layer scale 0.562589683e15






X.level before qkv: 1
(*X[0]).L 27
mlwe_num = 3072
scaler: 562829736533093
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.19597
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
111
mlwe_num = 3072
scaler: 562709515969372
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.4489
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
222
mlwe_num = 3072
scaler: 562469151873867
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.17958
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 18
after EvalModAndEqual level 6
after multConstAndEqual level 6
333
Q.level after qkv: 13
Q.level before qk: 13
Q.scale before qk: 0.562709683e15
const scale6802415574
const scale6802415574
const scale6802415574
O.level after qk: 8
O.scale after qk: 0.5546425768e15
O.scale before attn_Softmax_phase1: 0.5546425768e15
level at begin 8
level at begin 8
level at begin 8
O.scale after attn_Softmax_phase1: 0.4437140615e16
O.level after softmax1: 3
O.scale before softmax2: 0.443714069e16
O.level before softmax2: 15
before evalSoftMax_phase2 scale 0.443714069e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4437140729e16
cipher->scale = 0.4437140729e16
bx->scale = 0.4437140729e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5195078047e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5195078047e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3041241823e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3041241823e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3591898983e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1940462624e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1453834695e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1453834695e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2163423525e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5587104207e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5274118427e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5274118427e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8299433812e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.777550383e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7761822636e28
target_scale = 0.4437140729e16
bx->scale = 0.7761822636e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4437140729e16
tt = 1.7864444e-14
bx->scale = 0.4437140729e16
bx->scale = 7.881944994
after evalInv (*nonlieanr_buffer[0]).scale 7.881944994
after evalInv (*cipher_P[0]).scale 0.443714069e16
after evalSoftMax_phase2 scale 62.12505711
before evalSoftMax_phase2 scale 0.443714069e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4437140729e16
cipher->scale = 0.4437140729e16
bx->scale = 0.4437140729e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5195078047e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5195078047e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3041241823e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3041241823e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3591898983e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1940462624e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1453834695e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1453834695e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2163423525e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5587104207e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5274118427e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5274118427e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8299433812e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.777550383e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7761822636e28
target_scale = 0.4437140729e16
bx->scale = 0.7761822636e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4437140729e16
tt = 1.7864444e-14
bx->scale = 0.4437140729e16
bx->scale = 7.881944994
after evalInv (*nonlieanr_buffer[0]).scale 7.881944994
after evalInv (*cipher_P[0]).scale 0.443714069e16
after evalSoftMax_phase2 scale 62.12505711
before evalSoftMax_phase2 scale 0.443714069e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4437140729e16
cipher->scale = 0.4437140729e16
bx->scale = 0.4437140729e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.5195078047e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.5195078047e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.3041241823e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3041241823e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3591898983e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1940462624e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1453834695e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1453834695e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.2163423525e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5587104207e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.5274118427e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.5274118427e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.8299433812e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.777550383e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.7761822636e28
target_scale = 0.4437140729e16
bx->scale = 0.7761822636e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4437140729e16
tt = 1.7864444e-14
bx->scale = 0.4437140729e16
bx->scale = 7.881944994
after evalInv (*nonlieanr_buffer[0]).scale 7.881944994
after evalInv (*cipher_P[0]).scale 0.443714069e16
after evalSoftMax_phase2 scale 62.12505711
O.scale after softmax2: 62.12505711
O.level after softmax2: 7
O.level before mulV: 7
V.level before mulV: 6
O.scale before mulV: 62.12505711
V.scale before mulV: 0.5619886074e15
mulV_res.level after mulV: 4
mulV_res.scale after mulV: 62.01897092
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
mlwe_num = 3072
pcmm input level 4
scaler: 561988731657063
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 169.20883
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 27
after EvalModAndEqual level 15
after multConstAndEqual level 15
attn_output pcmm time 363.56711
O.level before LayerNorm phase 1: 15
O.scale before LayerNorm phase 1: 0.561029221e15
LayerNorm_Bert input scale 0.561029221e15
LayerNorm_Bert after sum_x scale 0.561029221e15
LayerNorm_Bert after reduce sum scale 0.561029226e15
LayerNorm_Bert after square sum_x scale 0.561029226e15
LayerNorm_Bert after square tmp_cipher scale 0.5591150466e15
LayerNorm_Bert after reduce sum phase1 scale 0.5591150466e15
LayerNorm_Bert after reduce sum phase2 scale 0.5591150494e15
LayerNorm_Bert before sqrtInv sum_x scale 0.5591150494e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.5591150494e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.561029221e15
LayerNorm_Bert finish scale 0.5572074219e15
O.level after LayerNorm phase 1: 5
O.scale after LayerNorm phase 1: 0.5572074219e15
attn_output_layernorm time 39.409664
O.level after LayerNorm phase 2: 4
O.scale after LayerNorm phase 2: 0.5572074407e15
scaler: 561029121892934
smem size:16384
call 1 mat_N = 768
pcmm_block(96, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
intermediate pcmm time 1221.9985
res[0].scale before evalGeLU: 0.5591150463e15
intermediate evalGeLU time 136.43367
res[0].scale after evalGeLU: 0.555306282e15
scaler: 559114815239556
smem size:16384
call 1 mat_N = 3072
pcmm_block(24, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 256
layer_output pcmm time 879.76855
before LayerNorm_phase1 LayerNorm_input[0] scale 0.5553058734e15
LayerNorm_Bert input scale 0.5553058734e15
LayerNorm_Bert after sum_x scale 0.5553058734e15
LayerNorm_Bert after reduce sum scale 0.5553058783e15
LayerNorm_Bert after square sum_x scale 0.5553058783e15
LayerNorm_Bert after square tmp_cipher scale 0.5477655938e15
LayerNorm_Bert after reduce sum phase1 scale 0.5477655938e15
LayerNorm_Bert after reduce sum phase2 scale 0.5477655966e15
LayerNorm_Bert before sqrtInv sum_x scale 0.5477655966e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.5477655966e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.5553058734e15
LayerNorm_Bert finish scale 0.540327719e15
after LayerNorm_phase1 LayerNorm_input[0] scale 0.540327719e15
layer_output LayerNorm time 39.596031
after LayerNorm_phase2 LayerNorm_input[0] scale 0.5403277372e15
after layer_output LayerNorm and s2c level 1
after layer scale 0.5403276967e15






X.level before qkv: 1
(*X[0]).L 27
mlwe_num = 3072
scaler: 555305775258776
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.56973
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
111
mlwe_num = 3072
scaler: 547765367203980
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.6752
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
222
mlwe_num = 3072
scaler: 532990330731746
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.78271
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 18
after EvalModAndEqual level 6
after multConstAndEqual level 6
333
Q.level after qkv: 13
Q.level before qk: 13
Q.scale before qk: 0.5477655298e15
const scale6802415574
const scale6802415574
const scale6802415574
O.level after qk: 8
O.scale after qk: 0.5116160225e15
O.scale before attn_Softmax_phase1: 0.5116160225e15
level at begin 8
level at begin 8
level at begin 8
O.scale after attn_Softmax_phase1: 0.409292818e16
O.level after softmax1: 3
O.scale before softmax2: 0.4092928249e16
O.level before softmax2: 15
before evalSoftMax_phase2 scale 0.4092928249e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4092928285e16
cipher->scale = 0.4092928285e16
bx->scale = 0.4092928285e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.4792068402e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.4792068402e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.2805316631e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2805316631e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3056229606e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.15229936e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1141058275e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1141058275e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.1566265119e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3174704417e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.2996859633e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2996859633e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.4350066763e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2315754522e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.2311679894e28
target_scale = 0.4092928285e16
bx->scale = 0.2311679894e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4092928285e16
tt = 5.5329464e-14
bx->scale = 0.4092928285e16
bx->scale = 7.270500887
after evalInv (*nonlieanr_buffer[0]).scale 7.270500887
after evalInv (*cipher_P[0]).scale 0.4092928249e16
after evalSoftMax_phase2 scale 52.86018335
before evalSoftMax_phase2 scale 0.4092928249e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4092928285e16
cipher->scale = 0.4092928285e16
bx->scale = 0.4092928285e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.4792068402e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.4792068402e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.2805316631e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2805316631e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3056229606e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.15229936e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1141058275e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1141058275e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.1566265119e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3174704417e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.2996859633e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2996859633e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.4350066763e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2315754522e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.2311679894e28
target_scale = 0.4092928285e16
bx->scale = 0.2311679894e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4092928285e16
tt = 5.5329464e-14
bx->scale = 0.4092928285e16
bx->scale = 7.270500887
after evalInv (*nonlieanr_buffer[0]).scale 7.270500887
after evalInv (*cipher_P[0]).scale 0.4092928249e16
after evalSoftMax_phase2 scale 52.86018335
before evalSoftMax_phase2 scale 0.4092928249e16
before evalInv (*nonlieanr_buffer[0]).scale 0.4092928285e16
cipher->scale = 0.4092928285e16
bx->scale = 0.4092928285e16
after scheme.constSub(*bx, *ax, 2); bx->scale = 0.4792068402e16
before bx->scale = bx->scale / K_inv[0]; bx->scale = 0.4792068402e16
after bx->scale = bx->scale / K_inv[0]; bx->scale = 0.2805316631e16
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2805316631e16
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.3056229606e17
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.15229936e18
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.1141058275e18
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.1141058275e18
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.1566265119e19
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.3174704417e21
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.2996859633e21
before scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2996859633e21
before scheme.multAndEqual_23(*bx, *temp); temp->scale = 0.4350066763e22
after scheme.multAndEqual_23(*bx, *temp); bx->scale = 0.2315754522e28
after bx->scale = bx->scale / K_inv[i]; bx->scale = 0.2311679894e28
target_scale = 0.4092928285e16
bx->scale = 0.2311679894e28
upper_bound = 32
after bx->scale *= target_scale / bx->scale; bx->scale = 0.4092928285e16
tt = 5.5329464e-14
bx->scale = 0.4092928285e16
bx->scale = 7.270500887
after evalInv (*nonlieanr_buffer[0]).scale 7.270500887
after evalInv (*cipher_P[0]).scale 0.4092928249e16
after evalSoftMax_phase2 scale 52.86018335
O.scale after softmax2: 52.86018335
O.level after softmax2: 7
O.level before mulV: 7
V.level before mulV: 6
O.scale before mulV: 52.86018335
V.scale before mulV: 0.5046249907e15
mulV_res.level after mulV: 4
mulV_res.scale after mulV: 47.38355737
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
O.level before attn_output PCMM: 4
mlwe_num = 3072
pcmm input level 4
scaler: 504625102304740
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 168.75725
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 27
after EvalModAndEqual level 15
after multConstAndEqual level 15
attn_output pcmm time 363.32852
O.level before LayerNorm phase 1: 15
O.scale before LayerNorm phase 1: 0.4523430974e15
LayerNorm_Bert input scale 0.4523430974e15
LayerNorm_Bert after sum_x scale 0.4523430974e15
LayerNorm_Bert after reduce sum scale 0.4523431014e15
LayerNorm_Bert after square sum_x scale 0.4523431014e15
LayerNorm_Bert after square tmp_cipher scale 0.3634679747e15
LayerNorm_Bert after reduce sum phase1 scale 0.3634679747e15
LayerNorm_Bert after reduce sum phase2 scale 0.3634679765e15
LayerNorm_Bert before sqrtInv sum_x scale 0.3634679765e15
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.3634679765e15
LayerNorm_Bert after sqrtInv cipher[0] scale 0.4523430974e15
LayerNorm_Bert finish scale 0.2920548005e15
O.level after LayerNorm phase 1: 5
O.scale after LayerNorm phase 1: 0.2920548005e15
attn_output_layernorm time 39.610367
O.level after LayerNorm phase 2: 4
O.scale after LayerNorm phase 2: 0.2920548104e15
scaler: 452343017434522
smem size:16384
call 1 mat_N = 768
pcmm_block(96, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
in packing mlwe_num = 512
intermediate pcmm time 1224.6036
res[0].scale before evalGeLU: 0.3634679745e15
intermediate evalGeLU time 137.41364
res[0].scale after evalGeLU: 0.2346726776e15
scaler: 363467824283081
smem size:16384
call 1 mat_N = 3072
pcmm_block(24, 2052)
in packing mlwe_num = 512
in packing mlwe_num = 256
layer_output pcmm time 877.96942
before LayerNorm_phase1 LayerNorm_input[0] scale 0.234672505e15
LayerNorm_Bert input scale 0.234672505e15
LayerNorm_Bert after sum_x scale 0.234672505e15
LayerNorm_Bert after reduce sum scale 0.2346725071e15
LayerNorm_Bert after square sum_x scale 0.2346725071e15
LayerNorm_Bert after square tmp_cipher scale 0.978260762e14
LayerNorm_Bert after reduce sum phase1 scale 0.978260762e14
LayerNorm_Bert after reduce sum phase2 scale 0.978260767e14
LayerNorm_Bert before sqrtInv sum_x scale 0.978260767e14
ax.l: 11
LayerNorm_Bert after sqrtInv sum_x scale 0.978260767e14
LayerNorm_Bert after sqrtInv cipher[0] scale 0.234672505e15
LayerNorm_Bert finish scale 0.4077998617e14
after LayerNorm_phase1 LayerNorm_input[0] scale 0.4077998617e14
layer_output LayerNorm time 39.659519
after LayerNorm_phase2 LayerNorm_input[0] scale 0.4077998755e14
after layer_output LayerNorm and s2c level 1
after layer scale 0.4077998449e14






X.level before qkv: 1
(*X[0]).L 27
mlwe_num = 3072
scaler: 234672463504393
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 171.02541
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
111
mlwe_num = 3072
scaler: 97826035725453
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 170.57793
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 25
after EvalModAndEqual level 13
after multConstAndEqual level 13
222
mlwe_num = 3072
scaler: 16999615522633
smem size:16384
call 1 mat_N = 768
pcmm_block(24, 2052)
ppmm time 171.33568
in packing mlwe_num = 512
in packing mlwe_num = 256
after modUpQ0toQL level 18
after EvalModAndEqual level 6
after multConstAndEqual level 6
333
Q.level after qkv: 13
Q.level before qk: 13
Q.scale before qk: 0.9782606477e14
const scale6802415574
const scale6802415574
const scale6802415574
O.level after qk: 9
O.scale after qk: 0.1640565573e28
O.scale before attn_Softmax_phase1: 0.1640565573e28
level at begin 9
level at begin 9
level at begin 9
O.scale after attn_Softmax_phase1: 0.1312452458e29
O.level after softmax1: 4
bootstrapping cipher not on level0!!!
